import{r as _,n as k,o as u,c as i,a as v,t as p,l as y,b as c,e as h,v as S,f as j,F as w,j as A,w as D,d as E,p as M,k as N,u as x,m as F,i as I,h as q}from"./index-DL-XTWDG.js";import{_ as B,A as U,u as $}from"./useRecords-DCqClLHJ.js";import{o as C,s as V,n as L,A as R}from"./schemas-Cq3zgjc0.js";import{A as T}from"./AppButton-Cl4I1Rwi.js";const O={key:0,class:"error"},H={key:1,class:"error"},Q={class:"textarea-group"},z=["value"],G={key:2,class:"error"},J={__name:"RecordForm",props:{modelValue:Object,categories:Array,submitLabel:String},emits:["submit"],setup(b,{emit:n}){const s=b,g=n,t=_({...s.modelValue}),r=_({});k(()=>s.modelValue,o=>{t.value={...o}});const f=C({title:V().min(3,"Mínimo 3 caracteres"),duration:L({invalid_type_error:"Duração obrigatória"}).min(1,"Duração deve ser maior que 0"),category:V().min(1,"Selecione uma categoria"),notes:V().optional()});function d(){r.value={};try{const o=f.parse({...t.value,duration:Number(t.value.duration)});g("submit",o)}catch(o){o.issues&&o.issues.forEach(e=>{r.value[e.path[0]]=e.message})}}return(o,e)=>(u(),i("form",{onSubmit:M(d,["prevent"]),class:"form"},[v(R,{modelValue:t.value.title,"onUpdate:modelValue":e[0]||(e[0]=a=>t.value.title=a),label:"Título",placeholder:"Ex: Estudar Vue.js",required:""},null,8,["modelValue"]),r.value.title?(u(),i("p",O,p(r.value.title),1)):y("",!0),v(R,{modelValue:t.value.duration,"onUpdate:modelValue":e[1]||(e[1]=a=>t.value.duration=a),modelModifiers:{number:!0},label:"Duração (minutos)",type:"number",placeholder:"Ex: 60",required:""},null,8,["modelValue"]),r.value.duration?(u(),i("p",H,p(r.value.duration),1)):y("",!0),c("div",Q,[e[4]||(e[4]=c("label",{class:"label"},"Observações",-1)),h(c("textarea",{"onUpdate:modelValue":e[2]||(e[2]=a=>t.value.notes=a),rows:"4",class:"textarea",placeholder:"Adicione observações sobre a atividade..."},null,512),[[S,t.value.notes]])]),h(c("select",{"onUpdate:modelValue":e[3]||(e[3]=a=>t.value.category=a),class:"select"},[e[5]||(e[5]=c("option",{disabled:"",value:""},"Selecione uma categoria",-1)),(u(!0),i(w,null,A(b.categories,a=>(u(),i("option",{key:a,value:a},p(a),9,z))),128))],512),[[j,t.value.category]]),r.value.category?(u(),i("p",G,p(r.value.category),1)):y("",!0),v(T,{type:"submit"},{default:D(()=>[E(p(b.submitLabel),1)]),_:1})],32))}},K=B(J,[["__scopeId","data-v-5de4d16d"]]),P={class:"page"},te={__name:"RecordFormView",setup(b){const n=q(),s=F(),{addRecord:g,getRecord:t,updateRecord:r,categories:f}=$(),d=I(()=>s.params.id!=="new"),o=s.query.projectId?Number(s.query.projectId):null,e=_({title:"",duration:"",notes:"",category:""});N(()=>{if(d.value){const l=t(s.params.id);l?e.value={title:l.title,duration:l.duration,notes:l.notes||"",category:l.category||""}:n.push("/records")}});function a(l){const m={...l,projectId:o??null};d.value?r(s.params.id,m):g(m),o?n.push(`/projects/${o}`):n.push("/records")}return(l,m)=>(u(),i("div",null,[v(U,{title:d.value?"Editar Registro":"Novo Registro","show-back":"",onBack:m[0]||(m[0]=W=>x(n).back())},null,8,["title"]),c("div",P,[v(K,{"model-value":e.value,categories:x(f),"submit-label":d.value?"Salvar alterações":"Criar registro",onSubmit:a},null,8,["model-value","categories","submit-label"])])]))}};export{te as default};
